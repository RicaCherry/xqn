//author:rukey67,create:2010-12-12,update:2016-01-07
var UrsUtil={isIE6:(function(){return(window.XMLHttpRequest)?false:true;})(),isOpera:(function(){return(window.opera)?true:false;})(),trim:function(a){return a.replace(/(^\s*)|(\s*$)/g,"");},getPos:function(h){var c={};var f=window;var b=h;var a;if(f==window.top){if(b.offsetParent){while(b.offsetParent){b=b.offsetParent;if(b.currentStyle&&b.currentStyle.position=="fixed"){h.fix=a=true;break;}else{if(document.defaultView&&document.defaultView.getComputedStyle(b,null).position=="fixed"){h.fix=a=true;break;}}}}}c.top=h.getBoundingClientRect().top;c.left=h.getBoundingClientRect().left;while(f!=window.top){var e=f.parent.document.getElementsByTagName("iframe");for(var g=0,d=e.length;g<d;g++){if(e[g].contentWindow==f){h=e[g];break;}}c.top+=h.getBoundingClientRect().top;c.left+=h.getBoundingClientRect().left;f=f.parent;}if(!a){c.top+=f.document.documentElement.scrollTop+f.document.body.scrollTop;c.left+=f.document.documentElement.scrollLeft+f.document.body.scrollLeft;}return c;},getCookie:function(c){var b="(?:;)?"+c+"=([^;]*);?";var a=new RegExp(b);if(a.test(document.cookie)){return decodeURIComponent(RegExp["$1"]);}else{return null;}},addEvent:function(d,a,b){try{d.addEventListener(a,b,false);}catch(c){d.attachEvent("on"+a,b);}}};var AutoUrs={ini:function(){this.doc=window.self==window.top?document:window.top.document;if(!this.doc.getElementById("RKS")){var c="#selCont{position:absolute; z-index:1000010; display:none;overflow:hidden; text-align:left;background-color:#FFFFFF; border:1px solid #ccc; font-size:12px;font-family:Arial,sans-serif;}#selCont h3{font-size:12px; padding:6px 6px 3px; margin:0; font-weight:normal; color:#999;height:auto;width:auto;line-height:1em;}#selCont div{position:relative; left:0; top:0; z-index:1000012}#selCont ul {list-style:none; text-align:left; margin:0; padding:0;font-size:0;}#selCont ul li{line-height:20px;font-size:12px; padding:2px 6px;cursor:pointer; color:#666;}#selCont ul li.on {background-color:#2d8bff; color:#fff;font-weight:bold;}.ursIni{color:#999;}";var a=this.doc.createElement("style");a.type="text/css";a.id="RKS";try{a.styleSheet.cssText=c;}catch(b){try{a.innerHTML=c;}catch(b){a.appendChild(this.doc.createTextNode(c));}}this.doc.getElementsByTagName("head")[0].appendChild(a);}if(this.selCont=this.doc.getElementById("selCont")){this.ulSel=this.doc.getElementById("ulSel");return;}this.selCont=this.doc.createElement("div");this.selCont.id="selCont";this.selCont.innerHTML="<div><h3>--\u8BF7\u9009\u62E9\u5E10\u53F7--</h3><ul id='ulSel'></ul></div>";if(UrsUtil.isIE6){this.selCont.innerHTML+="<iframe src='javascript:' frameborder='0' style='position:absolute;left:0;top:0;z-index:1000011;filter:alpha(opacity=0);margin:0;border:none;width:800px;height:800px;'></iframe>";}var d=this;if(this.doc.onreadystatechange===undefined){(function(){if(d.doc.body){d.doc.body.appendChild(d.selCont);d.ulSel=d.doc.getElementById("ulSel");}else{setTimeout(arguments.callee,20);}})();}else{if(this.doc.readyState=="complete"){this.doc.body.appendChild(d.selCont);this.ulSel=d.doc.getElementById("ulSel");return;}UrsUtil.addEvent(this.doc,"readystatechange",function(){if(d.doc.readyState=="complete"){d.doc.body.appendChild(d.selCont);d.ulSel=d.doc.getElementById("ulSel");}});}},bind:function(c,b){this.iUrs=document.getElementById(c);var b=b?b:{};b.mailList=b.mailList?b.mailList:["http://res.nie.netease.com/ps/tool/163.com","http://res.nie.netease.com/ps/tool/126.com","http://res.nie.netease.com/ps/tool/yeah.net","http://res.nie.netease.com/ps/tool/vip.163.com","http://res.nie.netease.com/ps/tool/vip.126.com","http://res.nie.netease.com/ps/tool/188.com","http://res.nie.netease.com/ps/tool/netease.com"];b.cookie=b.cookie?b.cookie:"none";this.iUrs.defaultUrs=b.placeholder?b.placeholder:"\u5982name@example.com";if(this.iUrs.value==""){if(b.cookie=="global"){var a=UrsUtil.getCookie("P_INFO")?UrsUtil.getCookie("P_INFO").split("|")[0]:null;}else{if(b.cookie!="none"){var a=UrsUtil.getCookie(b.cookie);}}if(a){this.iUrs.value=a;}else{this.iUrs.className+=" ursIni";this.iUrs.value=this.iUrs.defaultUrs;}}this.iUrs.tabTo=b.tabTo;this.iUrs.mails=b.mailList;this.iUrs.selIndex=0;this.iUrs.inList=false;this.eventHandler();this.setPos();},eventHandler:function(){var a=this;UrsUtil.addEvent(window.top,"resize",function(){a.setPos.call(a);});UrsUtil.addEvent(this.iUrs,"keydown",function(b){a.down.call(a,b);});UrsUtil.addEvent(a.iUrs,"keypress",function(b){a.press.call(a,b);});this.iUrs.onfocus=function(){if(this.className.indexOf("ursIni")!=-1){this.value="";this.className=this.className.replace("ursIni","");}this.select();a.iUrs=this;a.iUrs.inList=false;if(a.ulSel){a.ulSel.innerHTML="";}a.setPos();};this.iUrs.onblur=function(){a.setVal();};window.onscroll=function(){if(a.selCont.style.display=="block"){a.setPos();}};},setPos:function(){var a=UrsUtil.getPos(this.iUrs);if(this.iUrs.fix){this.selCont.style.position="fixed";}this.selCont.style.left=a.left+"px";this.selCont.style.top=a.top+this.iUrs.offsetHeight+1+"px";},press:function(c){var d=this;var c=c||window.event;var a=c.keyCode;if(UrsUtil.isOpera){setTimeout(function(){d.update(a);},20);}if(a==13){this.setVal();try{c.preventDefault();}catch(b){c.returnValue=false;}if(d.doc.getElementById(d.iUrs.tabTo)){d.doc.getElementById(d.iUrs.tabTo).focus();}}},down:function(b){var c=this;var b=b||window.event;var a=b.keyCode;if(!UrsUtil.isOpera){setTimeout(function(){c.update(a);},20);}},setVal:function(){if(UrsUtil.trim(this.iUrs.value)!=""&&this.iUrs.inList){this.iUrs.value=this.ulSel.childNodes[this.iUrs.selIndex].innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">");}else{if(UrsUtil.trim(this.iUrs.value)==""){this.iUrs.className+=" ursIni";this.iUrs.value=this.iUrs.defaultUrs;}}this.selCont.style.display="none";},update:function(a){var n=UrsUtil.trim(this.iUrs.value);n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;");if(a!=13&&a!=17){if(n==""){this.selCont.style.display="none";return;}else{if(a==16||a==9){return;}this.selCont.style.display="block";}if(a!=38&&a!=40){var k=[];if(n.indexOf("@")>=0){var g=n.indexOf("@");var j=n.substring(g+1);var h=false;for(var c=0,b=this.iUrs.mails.length;c<b;c++){if(this.iUrs.mails[c].indexOf(j)==0){h=true;k.push("<li>"+n.substring(0,g)+"@"+this.iUrs.mails[c]+"</li>");}else{this.iUrs.selIndex=0;continue;}}this.iUrs.inList=h;if(!h){this.selCont.style.display="none";return;}}else{this.iUrs.inList=true;for(var c=0,b=this.iUrs.mails.length;c<b;c++){k.push("<li>"+n+"@"+this.iUrs.mails[c]+"</li>");}}k=k.join("");this.ulSel.innerHTML=k;this.selCont.style.width="auto";this.selCont.style.width=(this.selCont.offsetWidth<this.iUrs.offsetWidth)?this.iUrs.offsetWidth-2+"px":"";this.ulSel.childNodes[this.iUrs.selIndex].className="on";var m=this.ulSel.getElementsByTagName("li");var d=this;for(var c=0,b=m.length;c<b;c++){m[c].index=c;m[c].onmouseover=function(){m[d.iUrs.selIndex].className="";d.iUrs.selIndex=this.index;m[d.iUrs.selIndex].className="on";};}}if(a==38||a==40){try{this.ulSel.childNodes[this.iUrs.selIndex].className="";if(a==38){this.iUrs.selIndex--;}else{if(a==40){this.iUrs.selIndex++;}}var m=this.ulSel.getElementsByTagName("li");if(this.iUrs.selIndex>=m.length){this.iUrs.selIndex=0;}if(this.iUrs.selIndex<0){this.iUrs.selIndex=m.length-1;}m[this.iUrs.selIndex].className="on";}catch(f){}}}}};AutoUrs.ini();